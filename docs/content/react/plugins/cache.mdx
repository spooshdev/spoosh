---
title: Cache
description: Response caching with configurable stale time
---

The cache plugin stores API responses and serves them instantly on subsequent requests, reducing network usage and improving perceived performance.

## Installation

```package-install
@spoosh/plugin-cache
```

## Usage

```typescript
import { Spoosh } from "@spoosh/core";
import { cachePlugin } from "@spoosh/plugin-cache";

const client = new Spoosh<ApiSchema, Error>("/api").use([
  cachePlugin({ staleTime: 5000 }),
]);
```

Data is considered "fresh" for the duration of `staleTime`. During this period, subsequent requests return cached data without making a network request.

## Per-Request Override

```typescript
// Use longer cache time for static data
useRead((api) => api.settings.$get(), { staleTime: 60000 });

// Disable caching for real-time data
useRead((api) => api.live.$get(), { staleTime: 0 });
```

## Options

### Plugin Config

| Option      | Type     | Default | Description                        |
| ----------- | -------- | ------- | ---------------------------------- |
| `staleTime` | `number` | `0`     | Default stale time in milliseconds |

### Per-Request Options

| Option      | Type     | Description                          |
| ----------- | -------- | ------------------------------------ |
| `staleTime` | `number` | Override stale time for this request |

## How It Works

1. First request fetches from network and stores in cache
2. Subsequent requests within `staleTime` return cached data instantly
3. After `staleTime` expires, next request fetches fresh data
4. Cache is automatically invalidated when using `invalidationPlugin`

## Combining with Invalidation

For automatic cache updates after mutations, combine with `invalidationPlugin`:

```typescript
import { Spoosh } from "@spoosh/core";
import { cachePlugin } from "@spoosh/plugin-cache";
import { invalidationPlugin } from "@spoosh/plugin-invalidation";

const client = new Spoosh<ApiSchema, Error>("/api").use([
  cachePlugin({ staleTime: 5000 }),
  invalidationPlugin(),
]);
```

When a mutation succeeds, related cached queries are automatically refreshed.

## Clearing Cache

The plugin exposes a `clearCache` function for manually clearing all cached data. This is useful for scenarios like user logout or switching accounts:

```typescript
import { createReactSpoosh } from "@spoosh/react";

const { useRead, clearCache } = createReactSpoosh(client);

function LogoutButton() {
  const handleLogout = () => {
    clearCache();
    // ... rest of logout logic
  };

  return <button onClick={handleLogout}>Logout</button>;
}
```

### Instance API

| Method       | Description                                              |
| ------------ | -------------------------------------------------------- |
| `clearCache` | Clears all cached data. Useful for logout/user switching |
