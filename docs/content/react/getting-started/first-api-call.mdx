---
title: First API Call
description: Make your first type-safe API call with Spoosh
---

This guide walks through making different types of API calls with Spoosh.

## Reading Data

Use `useRead` to fetch data:

```tsx
import { useRead } from "../api/client";

function UserProfile({ userId }: { userId: number }) {
  const { data, loading, error } = useRead((api) =>
    api("users/:id").GET({ params: { id: userId } })
  );

  if (loading) return <Spinner />;
  if (error) return <ErrorMessage error={error} />;

  return (
    <div>
      <h1>{data?.name}</h1>
      <p>{data?.email}</p>
    </div>
  );
}
```

### With Query Parameters

```tsx
function SearchUsers({ query }: { query: string }) {
  const { data } = useRead((api) =>
    api("search").GET({ query: { q: query, page: 1 } })
  );

  return (
    <ul>
      {data?.map((user) => (
        <li key={user.id}>{user.name}</li>
      ))}
    </ul>
  );
}
```

### Conditional Fetching

```tsx
function UserProfile({ userId }: { userId: number | null }) {
  const { data, loading } = useRead(
    (api) => api("users/:id").GET({ params: { id: userId! } }),
    { enabled: userId !== null }
  );

  // ...
}
```

## Writing Data

Use `useWrite` for mutations (POST, PUT, DELETE):

```tsx
import { useWrite } from "../api/client";

function CreateUserForm() {
  const { trigger, loading, error } = useWrite((api) => api("users").POST());

  const handleSubmit = async (e: React.FormEvent<HTMLFormElement>) => {
    e.preventDefault();
    const formData = new FormData(e.currentTarget);

    const result = await trigger({
      body: {
        name: formData.get("name") as string,
        email: formData.get("email") as string,
      },
    });

    if (result.data) {
      console.log("Created user:", result.data);
    }
  };

  return (
    <form onSubmit={handleSubmit}>
      <input name="name" placeholder="Name" required />
      <input name="email" type="email" placeholder="Email" required />
      <button type="submit" disabled={loading}>
        {loading ? "Creating..." : "Create User"}
      </button>
      {error && <p className="error">{error.message}</p>}
    </form>
  );
}
```

### Update and Delete

```tsx
function UserActions({ userId }: { userId: number }) {
  const { trigger: updateUser } = useWrite((api) => api("users/:id").PUT());

  const { trigger: deleteUser } = useWrite((api) => api("users/:id").DELETE());

  const handleUpdate = async () => {
    await updateUser({
      params: { id: userId },
      body: { name: "Updated Name" },
    });
  };

  const handleDelete = async () => {
    await deleteUser({ params: { id: userId } });
  };

  return (
    <div>
      <button onClick={handleUpdate}>Update</button>
      <button onClick={handleDelete}>Delete</button>
    </div>
  );
}
```

## Dynamic Path Parameters

Spoosh supports dynamic path segments with the path-based API:

```tsx
// useRead: Pass params in the options
const userId = 123;
const { data } = useRead((api) =>
  api("users/:id").GET({ params: { id: userId } })
);

// useWrite: Pass params when triggering
const { trigger: updateUser } = useWrite((api) => api("users/:id").PUT());
await updateUser({ params: { id: userId }, body: { name: "New Name" } });

// Nested params
const { data } = useRead((api) =>
  api("users/:userId/posts/:postId").GET({ params: { userId: 1, postId: 42 } })
);

// useWrite with DELETE
const { trigger: deletePost } = useWrite((api) =>
  api("users/:userId/posts/:postId").DELETE()
);
await deletePost({ params: { userId: 1, postId: 42 } });
```

**Recommended:** Use descriptive param names like `:userId` and `:postId` for clarity.

## Response Format

All API calls return a `SpooshResponse`:

```typescript
type SpooshResponse<TData, TError> = {
  status: number; // HTTP status code
  data: TData | undefined; // Response data (if successful)
  error: TError | undefined; // Error data (if failed)
  headers?: Headers; // Response headers
  aborted?: boolean; // True if request was aborted
};
```

## Next Steps

<Cards>
  <Card title="useRead Hook" href="/docs/react/hooks/use-read" />
  <Card title="useWrite Hook" href="/docs/react/hooks/use-write" />
  <Card title="Plugins" href="/docs/react/plugins" />
</Cards>
